---
- name: redis tasks
  hosts: all
  vars:
    target_env: "{{ lookup('env', 'target') }}"
  roles:
  - update-apt-sources-1.0.0
  - disable-apt-jobs-1.0.0
  - disable-motd-1.0.0
  - app-agent-1.0.6
  - arping-1.0.0
  - appctl
  - jq-1.0.9
  - ifupdown
  - role: set-timezone-1.0.0
    vars:
      timezone: "Asia/Shanghai"
  - role: redis-server-1.1.0
    vars:
      version: "{{ redis_version }}"
  - role: caddy-1.0.6
    vars:
      caddy_plugins: upload
  - role: zabbix-agent2-1.0.0
    vars:
      zabbix_agent2_version: "5.4.4"
      zabbix_version: "5.4"
      os_version: "18.04"

- name: redis standalone
  hosts: redis-standalone
  tasks:
  - include_role:
      name: "{{ name }}"
    loop:
    - redis-standalone
    loop_control:
      loop_var: name

- name: redis cluster
  hosts: redis-cluster
  tasks:
  - include_role:
      name: "{{ name }}"
    loop:
    - redis-cluster
    loop_control:
      loop_var: name

- name: online-setup 
  hosts: online-setup 
  tasks:
  - include_role:
      name: "online-setup"
